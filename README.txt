_________________________________________________________________________________________________
		
					Snapshot - Guide
_________________________________________________________________________________________________




-------------------------------------------------------------------------------------------------
1) Abstract
-------------------------------------------------------------------------------------------------

The tool is born as an answer while working on vulnerability management issues for a PCI DSS 
recertification project. The tools already available was Qualys VA and Skybox Security.
Having to manage many versions instances of assessment and being bored of doing it in Excel, we 
developed a tool to help managing the vulnerability by an operating point of view. Hereafter 
follow some of the daily needs we have addressed with the tool: 

	-> Many times there was the need to wrap together the result of different scans (for 
	   tactical reasons it may be useful to split the scope in narrower slices) and consider 
	   them as a whole.

	-> The Cardholder Data Environment (CDE) is in continuously changing while the 
	   certification process progresses and it can be useful to select the trend of only the 
	   remainder hosts when you have to give the snapshot to the Qualified Security Assessor 
	   (QSA).

	-> Visualize the vulnerability trend selecting the type of vulnerabilities to be 
	   displayed (vulns, practices, services, infos).

	-> Freeze hosts and vulnerabilities to see what has changed on the next scan temporary 
	   hiding by the new vulnerabilities or systems. This enables to understand how well 
	   you have worked on remediating old vulnerabilities.

	-> Understand if the new vulnerabilities come from an update in the signatures of the 
	   scanner or from something else such as the change of the network environment (i.e. 
	   firewall rule-bases) or from a new host came in.

	-> Focus with priority on vulnerability that are reachable.


-------------------------------------------------------------------------------------------------
2) Introduction
-------------------------------------------------------------------------------------------------

Snapshot is a graphical tool designed by ICT Consulting S.p.A. in order to help managers to have 
a simple but effective perception about the threat level of their network over time.
It consists in a program written in Java and XSL languages that parses and elaborates the XML 
report generated by Qualys. It gives in output:

	-> an histogram plot in which each bar represents the total amount of threats found 
  	   divided per type (i.e. VULNS, PRACTICES, SERVICES and INFOS) and severity (i.e. INFO,
	   LOW, MEDIUM, HIGH and CRITICAL).

	-> a dispersion plot where each dot represents a host analyzed by Qualys.

Along this basic representation, Snapshot offers a set of additional features such as filtering, 
searching, reporting and comparing.
This version of Snapshot works only for Windows users.


-------------------------------------------------------------------------------------------------
3) How to launch Snapshot
-------------------------------------------------------------------------------------------------

Just follow these few steps:
	
	3.1) Put the XML Qualys files into the ascending numbered directories (max. 6) you find 
	     in the main folder. Each directory represents what we call a "snapshot".
	     A maximum number of six files per folder is suggested for a better visualization.

	3.2) Execute "snapshot.jar" and then press the button "Add Snapshot" until you reach the 
	     last directory.

	3.3) Enjoy Snapshot!

NB: During step 3.1, when you are adding a new snapshot, it is important to put just the xml 
reports yiel by Qualys in the directories. Snapshot will provide to parse them and generate a 
summary (header.txt and body.txt). If you have less than six snapshots leave the extra folders 
empty.


-------------------------------------------------------------------------------------------------
4) Feature description
-------------------------------------------------------------------------------------------------

Once the data have been loaded, Snapshot permits to disclose/hide dinamically each type of 
element that Qualys found (VULNS, PRACTICES, SERVICES and INFOS) in his analysis and to exploit 
additional information by clicking the hosts and the analysis milestones (respectively the black 
and the red dots). Then you can trigger some additional functionalities:
	
	4.1) Filtering
	     You can either display only threats with PCI_FLAG set to 1, just a subset of hosts
	     with common characteristics (such as the components of the CDE) or only those 
	     elements flagged as exposed.
	     Every combination of these filters is possible in Snapshot.
	     Moreover, you can disaggregate each element in term of single CVE ID.
	
	4.2) Searching
	     The "Search" function permits to select the single element (either by its name, QID 
	     or CVE-ID) to display among those found by Qualys. It also gives a graphical and 
	     powerful representation of which hosts are affected by that element.
	
	4.3) Comparing
	     Snapshot offers also a graphical representation about the state of each snapshot 
	     w.r.t. the threats found in a given snapshot that we call "benchmark". 
	
	4.4) Reporting
	     Finally, Snapshot can generate reports in output concerning the current state 
	     visualized in the main window. Reports are saved into "\report" folder.

The backgroud color of each analysis reflects changes int the vulnerability signature version 
used by Qualys. 


------------------------------------------------------------------------------------------------
5) Configuration File (optional)
------------------------------------------------------------------------------------------------

The config.xml file permits to define your own CDE along to a list of the exposed elements of 
your network. The xml structure of this file is the following:

<CONFIG>
	<CDE></CDE>
	<EXPOSED>
		<SNAPSHOT>
			<ID></ID>
			<ELEMENT></ELEMENT>
			...
			<ELEMENT></ELEMENT>
		</SNAPSHOT>
		...
		<SNAPSHOT>
			<ID></ID>
			<ELEMENT></ELEMENT>
			...
			<ELEMENT></ELEMENT>
		</SNAPSHOT>
	</EXPOSED>
</CONFIG>

You can define your own CDE structure by manually typing the subset of hosts between the 
<CDE></CDE> tags either in the "x.x.x.x-x.x.x.y" or the "x.x.x.x" form.
While, the exposed elements can be placed between the tags <EXPOSED></EXPOSED>. There, for each 
snapshot, you have to write a <SNAPSHOT></SNAPSHOT> couple and fill the <ID></ID> field followed
by a list of elements you know are exposed.
Each entry has the following structure:

	"<ELEMENT>IP_address,port_number,QID,CVE-ID</ELEMENT>"

If an attribute is not avaiable can be left blank, while the special charactrer '*' (means "all") 
can be used as a substitute for the value of attributes in order to ease the insertion.
A config.xml sample can be found in the downloaded folder.


-------------------------------------------------------------------------------------------------
6) Future works
-------------------------------------------------------------------------------------------------

We are working to extend the limit of the maximum number of snapshots in visualization. In 
addition we would provide some customization options in reporting.


-------------------------------------------------------------------------------------------------
7) Contacts
-------------------------------------------------------------------------------------------------

Cristiano Conti (conti@ictc.it) and Simone Fontana (fontana@ictc.it).



Copyright (c) 2014 ICT Consulting